!function(){"use strict";"use strict";var e=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],t=new(function(){var t;function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e;if(!(this instanceof r))throw TypeError("Cannot call a class as a function");if(this.board=t,this.score=0,this.newTile=null,this.mergedTiles=[],this.field=document.querySelector(".game-field"),!this.field)throw Error("Не знайдено елемент .game-field в DOM!");this.initBoard(),this.renderBoard()}return t=[{key:"filterZero",value:function(e){return e.filter(function(e){return 0!==e})}},{key:"initBoard",value:function(){this.cells=[],this.field.innerHTML="";for(var e=0;e<4;e++){this.cells[e]=[];for(var t=0;t<4;t++){var r=document.createElement("div");r.classList.add("field-cell"),this.field.appendChild(r),this.cells[e][t]=r}}}},{key:"renderBoard",value:function(){for(var e=0;e<4;e++)for(var t,r=0;r<4;r++)t=this,function(r){var s=t.cells[e][r],i=t.board[e][r];s.textContent=i||"",s.className="field-cell".concat(i?" field-cell--".concat(i):""),t.newTile&&t.newTile.row===e&&t.newTile.col===r&&(s.classList.add("field-cell--new"),s.addEventListener("animationend",function(){return s.classList.remove("field-cell--new")},{once:!0}))}(r);var s=document.querySelector(".game-score");s&&(s.textContent=String(this.score))}},{key:"spawnNumber",value:function(){for(var e=[],t=0;t<4;t++)for(var r=0;r<4;r++)0===this.board[t][r]&&e.push({row:t,col:r});if(0!==e.length){var s=e[Math.floor(Math.random()*e.length)];this.board[s.row][s.col]=2,this.newTile=s,this.renderBoard(),this.newTile=null}}},{key:"isGameOver",value:function(){for(var e=0;e<4;e++)for(var t=0;t<4;t++)if(2048===this.board[e][t])return"win";for(var r=0;r<4;r++)for(var s=0;s<4;s++)if(0===this.board[r][s]||s<3&&this.board[r][s]===this.board[r][s+1]||r<3&&this.board[r][s]===this.board[r+1][s])return"playing";return"lose"}},{key:"boardsAreEqual",value:function(e,t){for(var r=0;r<4;r++)for(var s=0;s<4;s++)if(e[r][s]!==t[r][s])return!1;return!0}},{key:"moveLeft",value:function(){for(var e=JSON.parse(JSON.stringify(this.board)),t=0;t<4;t++){var r=this.board[t];r=this.filterZero(r);for(var s=0;s<r.length-1;s++)r[s]===r[s+1]&&(r[s]*=2,r[s+1]=0,this.score+=r[s],this.mergedTiles.push({row:t,col:s}));for(r=this.filterZero(r);r.length<4;)r.push(0);this.board[t]=r}this.renderBoard(),this.boardsAreEqual(e,this.board)||this.spawnNumber(),this.checkGameStatus()}},{key:"moveRight",value:function(){for(var e=JSON.parse(JSON.stringify(this.board)),t=0;t<4;t++){var r=this.board[t].reverse();r=this.filterZero(r);for(var s=0;s<r.length-1;s++)r[s]===r[s+1]&&(r[s]*=2,r[s+1]=0,this.score+=r[s],this.mergedTiles.push({row:t,col:3-s}));for(r=this.filterZero(r);r.length<4;)r.push(0);this.board[t]=r.reverse()}this.renderBoard(),this.boardsAreEqual(e,this.board)||this.spawnNumber(),this.checkGameStatus()}},{key:"moveUp",value:function(){var e=JSON.parse(JSON.stringify(this.board));this.mergedTiles=[];for(var t=0;t<4;t++){for(var r=[],s=0;s<4;s++)r.push(this.board[s][t]);r=this.filterZero(r);for(var i=0;i<r.length-1;i++)r[i]===r[i+1]&&(r[i]*=2,r[i+1]=0,this.score+=r[i],this.mergedTiles.push({row:i,col:t}));for(r=this.filterZero(r);r.length<4;)r.push(0);for(var o=0;o<4;o++)this.board[o][t]=r[o]}this.renderBoard(),this.boardsAreEqual(e,this.board)||this.spawnNumber(),this.checkGameStatus()}},{key:"moveDown",value:function(){var e=JSON.parse(JSON.stringify(this.board));this.mergedTiles=[];for(var t=0;t<4;t++){for(var r=[],s=0;s<4;s++)r.push(this.board[s][t]);(r=this.filterZero(r)).reverse();for(var i=0;i<r.length-1;i++)r[i]===r[i+1]&&(r[i]*=2,r[i+1]=0,this.score+=r[i],this.mergedTiles.push({row:3-i,col:t}));for(r=this.filterZero(r);r.length<4;)r.push(0);r.reverse();for(var o=0;o<4;o++)this.board[o][t]=r[o]}this.renderBoard(),this.boardsAreEqual(e,this.board)||this.spawnNumber(),this.checkGameStatus()}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){var e=document.querySelector(".message-container").querySelector("p:not(.hidden)");return e?e.classList.contains("message-start")?"idle":e.classList.contains("message-win")?"win":e.classList.contains("message-lose")?"lose":void 0:"playing"}},{key:"checkGameStatus",value:function(){var e=this.isGameOver();("win"===e||"lose"===e)&&this.showMessage(e)}},{key:"showMessage",value:function(e){document.querySelector(".message.message-".concat(e)).classList.remove("hidden"),document.removeEventListener("keydown",this.boundKeyDown)}},{key:"start",value:function(){this.initBoard(),this.spawnNumber(),this.spawnNumber(),document.querySelectorAll(".message").forEach(function(e){return e.classList.add("hidden")}),this.boundKeyDown=this.keyDown.bind(this),document.addEventListener("keydown",this.boundKeyDown)}},{key:"restart",value:function(){for(var e,t,r,s=0;s<4;s++)for(var i=0;i<4;i++){this.board[s][i]=0;var o=this.cells[s][i];o.textContent="",o.className="field-cell"}null==(e=document.querySelector(".message.message-lose"))||e.classList.add("hidden"),null==(t=document.querySelector(".message.message-win"))||t.classList.add("hidden"),null==(r=document.querySelector(".message.message-start"))||r.classList.add("hidden"),document.removeEventListener("keydown",this.boundKeyDown),this.newTile=null,this.score=0,this.renderBoard(),this.spawnNumber(),this.spawnNumber(),this.boundKeyDown=this.keyDown.bind(this),document.addEventListener("keydown",this.boundKeyDown)}},{key:"keyDown",value:function(e){switch(e.preventDefault(),e.key){case"ArrowUp":this.moveUp();break;case"ArrowDown":this.moveDown();break;case"ArrowLeft":this.moveLeft();break;case"ArrowRight":this.moveRight()}this.checkGameStatus()}}],function(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}(r.prototype,t),r}()),r=document.querySelector("button.start");r.addEventListener("click",function(){"idle"===t.getStatus()?(r.classList.remove("start"),r.classList.add("restart"),r.textContent="Restart",t.start()):(r.classList.remove("start"),r.classList.add("restart"),r.textContent="Restart",t.restart())})}();
//# sourceMappingURL=2048-game.a8e01888.js.map
